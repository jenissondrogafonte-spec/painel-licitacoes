<!DOCTYPE html>
<html>
<head>
<title>Licita√ß√µes ComprasNet</title>
<style>body{font-family:sans-serif;max-width:1000px;margin:auto;padding:20px}form input,form button{width:100%;padding:12px;margin:8px 0;border-radius:6px;border:1px solid #ddd;font-size:16px}button{background:#007cba;color:white;border:none;cursor:pointer;font-weight:bold}table{width:100%;border-collapse:collapse;margin-top:20px}th,td{border:1px solid #ddd;padding:10px;text-align:left}th{background:#007cba;color:white}</style>
</head>
<body>
<h1>üîç Consulta Licita√ß√µes ComprasNet</h1>
<form id="form">
<input id="uasg" placeholder="UASG (ex: 926150)" value="926150">
<input id="lic" placeholder="N¬∫ Licita√ß√£o (opcional)">
<input type="date" id="datai" value="2025-01-01">
<input type="date" id="dataf" value="2026-01-13">
<button>Buscar</button>
</form>
<div id="result"></div>

<script>
document.getElementById('form').onsubmit=async e=>{
e.preventDefault();
const uasg=document.getElementById('uasg').value;
const lic=document.getElementById('lic').value;
const datai=document.getElementById('datai').value;
const dataf=document.getElementById('dataf').value;
const params=new URLSearchParams({uasg,limit:30});
lic&&params.append('numero_aviso',lic);
datai&&params.append('data_publicacao_min',datai);
dataf&&params.append('data_publicacao_max',dataf);
const url='https://api.allorigins.win/get?url='+encodeURIComponent('http://compras.dados.gov.br/licitacoes/v1/licitacoes.json?'+params);
document.getElementById('result').innerHTML='Carregando...';
try{
const r=await fetch(url);
const d=await r.json();
const data=JSON.parse(d.contents);
let t='<table><tr><th>N¬∫</th><th>UASG</th><th>Data</th><th>Licita√ß√£o</th><th>Objeto</th></tr>';
if(data.resultado&&data.resultado.length){
data.resultado.slice(0,25).forEach((l,i)=>{
t+='<tr><td>'+(l.numero_aviso||i+1)+'</td><td>'+l.uasg+'</td><td>'+ (l.data_publicacao||'') +'</td><td>'+(l.modalidade||'')+'</td><td>'+(l.objeto||'').substring(0,60)+'</td></tr>';
});
t+='</table><p><strong>'+data.resultado.length+' resultados</strong></p>';
}else t+='<tr><td colspan=5 style="color:red;text-align:center">Nenhum resultado UASG '+uasg+'</td></tr></table>';
document.getElementById('result').innerHTML=t;
}catch(e){
document.getElementById('result').innerHTML='<p style="color:red">Erro: '+e+'<br>UASG '+uasg+' pode n√£o ter licita√ß√µes recentes</p>';
}
}
</script>
</body>
</html>
