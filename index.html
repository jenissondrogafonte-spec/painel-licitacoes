<script>
document.addEventListener('DOMContentLoaded', async () => {
  const status = document.getElementById('status') || document.createElement('div');
  status.id = 'status';
  status.style.color = 'green';
  status.style.fontWeight = 'bold';
  document.body.appendChild(status);

  // CSV direto do portal de dados (equivalente ao m√≥dulo 07 ‚Äì Contrata√ß√µes PNCP) [file:1]
  const csvUrl = 'https://dados.gov.br/dados/conjuntos-dados/compras-publicas-do-governo-federal/resources/comprasGOV-anual-VWFTPNCPCOMPRA-latest.csv';
  
  try {
    status.textContent = 'üîÑ Carregando CSV de Contrata√ß√µes PNCP (anual)...';
    
    const resp = await fetch(csvUrl);
    if (!resp.ok) throw new Error('CSV n√£o encontrado');
    
    const csvText = await resp.text();
    const linhas = csvText.split('\n').slice(1, 11); // primeiras 10 linhas
    
    status.textContent = `‚úÖ CSV carregado! ${linhas.length} registros preview.`;

    const tbody = document.getElementById('tbody');
    if (tbody) {
      linhas.forEach(linha => {
        const cols = linha.split(',');
        if (cols.length >= 6) {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${cols[0]}</td> <!-- ID -->
            <td>${cols[1]}</td> <!-- √ìrg√£o -->
            <td>${cols[2]}</td> <!-- UASG -->
            <td>${cols[3]}</td> <!-- Data -->
            <td>${cols[4]}</td> <!-- Valor Estimado -->
            <td>${cols[5]}</td> <!-- Valor Homologado -->
          `;
          tbody.appendChild(tr);
        }
      });
    }
    
    console.log('CSV preview:', linhas.slice(0,3));
    
  } catch (e) {
    status.textContent = '‚ùå Erro CSV: ' + e.message;
    status.style.color = 'red';
  }
});
</script>
